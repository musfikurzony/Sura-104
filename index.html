<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <title>সূরা আল-হুমাযাহ – ব্যাকরণসহ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Google Fonts -->
  <link
    href="https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@400;600&family=Noto+Sans+Bengali:wght@400;600&display=swap"
    rel="stylesheet"
  />

  <style>
    :root {
      --bg: #050816;
      --bg-soft: #0b1020;
      --accent: #22c55e;
      --accent-soft: rgba(34, 197, 94, 0.2);
      --text-main: #e5e7eb;
      --text-dim: #9ca3af;
      --border-soft: #1f2933;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background: radial-gradient(circle at top, #111827 0, #020617 45%, #000 100%);
      color: var(--text-main);
      font-family: "Noto Sans Bengali", system-ui, -apple-system, BlinkMacSystemFont,
        "Segoe UI", sans-serif;
      display: flex;
      justify-content: center;
      padding: 12px;
    }

    .app {
      width: 100%;
      max-width: 520px;
      background: linear-gradient(145deg, rgba(15, 23, 42, 0.96), rgba(15, 23, 42, 0.9));
      border-radius: 18px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      box-shadow:
        0 18px 60px rgba(0, 0, 0, 0.95),
        0 0 0 1px rgba(15, 23, 42, 0.85);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    header {
      padding: 10px 14px 8px;
      border-bottom: 1px solid var(--border-soft);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
    }

    .title-block {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .title-main {
      font-size: 15px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .badge {
      font-size: 11px;
      padding: 1px 6px;
      border-radius: 999px;
      background: rgba(34, 197, 94, 0.1);
      color: var(--accent);
      border: 1px solid rgba(34, 197, 94, 0.3);
    }

    .title-sub {
      font-size: 11px;
      color: var(--text-dim);
    }

    .settings-toggle {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 11px;
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.5);
      color: #e5e7eb;
      cursor: pointer;
    }

    .settings-toggle span.icon {
      font-size: 12px;
    }

    .settings-panel {
      padding: 8px 14px 6px;
      border-bottom: 1px solid var(--border-soft);
      display: none;
      gap: 10px;
      flex-wrap: wrap;
      background: radial-gradient(circle at top left, rgba(34, 197, 94, 0.15), transparent 55%);
    }

    .settings-panel.show {
      display: flex;
    }

    .toggle-chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      padding: 4px 9px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.85);
      cursor: pointer;
      user-select: none;
    }

    .toggle-chip input {
      accent-color: var(--accent);
    }

    .toggle-chip span.label {
      color: var(--text-main);
    }

    .content {
      flex: 1;
      overflow-y: auto;
      padding: 8px 12px 80px;
      scrollbar-width: thin;
      scrollbar-color: rgba(100, 116, 139, 0.7) transparent;
    }

    .content::-webkit-scrollbar {
      width: 6px;
    }

    .content::-webkit-scrollbar-track {
      background: transparent;
    }

    .content::-webkit-scrollbar-thumb {
      background: rgba(100, 116, 139, 0.7);
      border-radius: 999px;
    }

    .bismillah {
      text-align: center;
      margin: 4px 0 10px;
      padding-bottom: 6px;
      border-bottom: 1px dashed rgba(148, 163, 184, 0.4);
    }

    .bismillah-ar {
      font-family: "Noto Sans Arabic", system-ui;
      font-size: 22px;
      direction: rtl;
      unicode-bidi: bidi-override;
      margin-bottom: 4px;
    }

    .bismillah-bn {
      font-size: 11px;
      color: var(--text-dim);
    }

    .ayah-card {
      background: radial-gradient(circle at top, #020617 0, #020617 55%, #020617 100%);
      border-radius: 14px;
      padding: 9px 10px;
      margin-bottom: 8px;
      border: 1px solid rgba(55, 65, 81, 0.8);
      box-shadow: 0 10px 28px rgba(0, 0, 0, 0.9);
      position: relative;
    }

    .ayah-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
    }

    .ayah-number-circle {
      width: 22px;
      height: 22px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      color: var(--text-main);
    }

    .ayah-mode-tag {
      font-size: 10px;
      padding: 2px 7px;
      border-radius: 999px;
      background: rgba(31, 41, 55, 0.9);
      border: 1px solid rgba(75, 85, 99, 0.9);
      color: var(--text-dim);
    }

    .ayah-line-ar {
      font-family: "Noto Sans Arabic", system-ui;
      direction: rtl;
      unicode-bidi: bidi-override;
      text-align: right;
      font-size: 22px;
      line-height: 1.6;
      margin-bottom: 6px;
      cursor: default;
    }

    .ayah-translation {
      font-size: 12px;
      line-height: 1.55;
      color: var(--text-main);
      margin-bottom: 6px;
    }

    .ayah-translation.hidden {
      display: none;
    }

    .word-grid {
      margin-top: 4px;
      display: flex;
      flex-wrap: wrap;
      justify-content: flex-end;
      gap: 4px 6px;
    }

    .word-grid.hidden {
      display: none;
    }

    .word-pill {
      min-width: 70px;
      padding: 4px 6px 5px;
      border-radius: 10px;
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(55, 65, 81, 0.9);
      cursor: pointer;
      transition: background 0.12s, border-color 0.12s, transform 0.06s;
      text-align: center;
    }

    .word-pill:hover {
      background: rgba(15, 23, 42, 1);
      border-color: rgba(148, 163, 184, 0.9);
    }

    .word-pill.active {
      background: var(--accent-soft);
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.4);
      transform: translateY(-0.5px);
    }

    .word-pill-ar {
      font-family: "Noto Sans Arabic", system-ui;
      direction: rtl;
      unicode-bidi: bidi-override;
      font-size: 18px;
      margin-bottom: 1px;
    }

    .word-pill-bn {
      font-size: 11px;
      color: var(--text-dim);
      line-height: 1.2;
    }

    .grammar-panel {
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: 10px;
      width: 100%;
      max-width: 520px;
      padding: 0 10px;
      pointer-events: none;
    }

    .grammar-inner {
      pointer-events: auto;
      background: radial-gradient(circle at top left, rgba(34, 197, 94, 0.25), rgba(15, 23, 42, 0.98));
      border-radius: 14px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      box-shadow:
        0 -8px 30px rgba(0, 0, 0, 0.9),
        0 0 0 1px rgba(15, 23, 42, 0.95);
      padding: 7px 9px 8px;
      display: flex;
      gap: 6px;
      align-items: flex-start;
    }

    .grammar-word {
      font-family: "Noto Sans Arabic", system-ui;
      direction: rtl;
      unicode-bidi: bidi-override;
      font-size: 19px;
      padding: 4px 8px;
      border-radius: 10px;
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(148, 163, 184, 0.7);
      margin-bottom: 2px;
    }

    .grammar-texts {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .grammar-meaning {
      font-size: 12px;
      margin-bottom: 2px;
    }

    .grammar-notes {
      font-size: 12px; /* আগের ০.৯ / ১.০ থেকে একটু বড় */
      color: var(--text-dim);
      line-height: 1.5;
      max-height: 80px;
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: rgba(148, 163, 184, 0.7) transparent;
    }

    .grammar-notes::-webkit-scrollbar {
      width: 6px;
    }

    .grammar-notes::-webkit-scrollbar-thumb {
      background: rgba(148, 163, 184, 0.8);
      border-radius: 999px;
    }

    .grammar-close {
      font-size: 16px;
      cursor: pointer;
      padding: 3px;
      border-radius: 999px;
      color: var(--text-dim);
    }

    .grammar-close:hover {
      background: rgba(15, 23, 42, 0.9);
      color: #e5e7eb;
    }

    .grammar-panel.hidden {
      display: none;
    }

    @media (max-width: 400px) {
      .ayah-line-ar {
        font-size: 20px;
      }
      .word-pill-ar {
        font-size: 16px;
      }
      .grammar-word {
        font-size: 17px;
      }
      .grammar-notes {
        font-size: 11px;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="title-block">
        <div class="title-main">
          সূরা আল-হুমাযাহ
          <span class="badge">১০৪</span>
        </div>
        <div class="title-sub">ব্যাকরণসহ অধ্যয়ন মোড</div>
      </div>
      <button id="openSettings" class="settings-toggle" type="button">
        <span class="icon">⚙️</span>
        <span>ভিউ সেটিংস</span>
      </button>
    </header>

    <div id="settingsPanel" class="settings-panel">
      <label class="toggle-chip">
        <input type="checkbox" id="toggleTranslation" />
        <span class="label">বাংলা অনুবাদ</span>
      </label>
      <label class="toggle-chip">
        <input type="checkbox" id="toggleWordByWord" />
        <span class="label">শব্দে-শব্দে</span>
      </label>
      <label class="toggle-chip">
        <input type="checkbox" id="toggleGrammar" />
        <span class="label">ব্যাকরণ নোট</span>
      </label>
    </div>

    <div class="content" id="content">
      <div class="bismillah">
        <div class="bismillah-ar" id="bismillahAr"></div>
        <div class="bismillah-bn" id="bismillahBn"></div>
      </div>
      <div id="ayahContainer"></div>
    </div>
  </div>

  <div id="grammarPanel" class="grammar-panel hidden">
    <div class="grammar-inner">
      <div>
        <div class="grammar-word" id="gWord">وَيْلٌ</div>
        <div class="grammar-meaning" id="gMeaning">ধ্বংস / আফসোস</div>
      </div>
      <div class="grammar-texts">
        <div class="grammar-notes" id="gNotes">
          এখানে নির্বাচিত শব্দের ব্যাকরণগত পরিচিতি দেখা যাবে।
        </div>
      </div>
      <div class="grammar-close" id="gClose">✕</div>
    </div>
  </div>

  <script>
    const toggleBtn = document.getElementById('openSettings');
    const settingsPanel = document.getElementById('settingsPanel');
    const toggleTranslation = document.getElementById('toggleTranslation');
    const toggleWordByWord = document.getElementById('toggleWordByWord');
    const toggleGrammar = document.getElementById('toggleGrammar');

    const ayahContainer = document.getElementById('ayahContainer');
    const bismillahAr = document.getElementById('bismillahAr');
    const bismillahBn = document.getElementById('bismillahBn');

    const grammarPanel = document.getElementById('grammarPanel');
    const gWord = document.getElementById('gWord');
    const gMeaning = document.getElementById('gMeaning');
    const gNotes = document.getElementById('gNotes');
    const gClose = document.getElementById('gClose');

    let grammarEnabled = false;
    let wordByWordEnabled = false;
    let translationEnabled = false;

    toggleBtn.addEventListener('click', () => {
      settingsPanel.classList.toggle('show');
    });

    toggleTranslation.addEventListener('change', () => {
      translationEnabled = toggleTranslation.checked;
      updateViewToggles();
    });

    toggleWordByWord.addEventListener('change', () => {
      wordByWordEnabled = toggleWordByWord.checked;
      updateViewToggles();
    });

    toggleGrammar.addEventListener('change', () => {
      grammarEnabled = toggleGrammar.checked;
      if (!grammarEnabled) {
        grammarPanel.classList.add('hidden');
        clearActiveWord();
      }
    });

    gClose.addEventListener('click', () => {
      grammarPanel.classList.add('hidden');
      clearActiveWord();
    });

    function updateViewToggles() {
      document.querySelectorAll('.ayah-card').forEach(card => {
        const transEl = card.querySelector('.ayah-translation');
        const gridEl = card.querySelector('.word-grid');

        if (transEl) {
          transEl.classList.toggle('hidden', !translationEnabled);
        }
        if (gridEl) {
          gridEl.classList.toggle('hidden', !wordByWordEnabled);
        }

        const tag = card.querySelector('.ayah-mode-tag');
        if (tag) {
          const modes = [];
          if (translationEnabled) modes.push('অনুবাদ');
          if (wordByWordEnabled) modes.push('শব্দে-শব্দে');
          if (modes.length === 0) {
            tag.textContent = 'শুধু আরবি';
          } else {
            tag.textContent = 'আরবি + ' + modes.join(' + ');
          }
        }
      });

      if (!wordByWordEnabled || !grammarEnabled) {
        grammarPanel.classList.add('hidden');
        clearActiveWord();
      }
    }

    function clearActiveWord() {
      document.querySelectorAll('.word-pill.active').forEach(el => {
        el.classList.remove('active');
      });
    }

    function setGrammarDetails(word, meaning, notes) {
      gWord.textContent = word || '';
      gMeaning.textContent = meaning || '';
      gNotes.textContent = notes || '';
      grammarPanel.classList.remove('hidden');
    }

    function createAyahCard(ayah) {
      const card = document.createElement('div');
      card.className = 'ayah-card';

      const header = document.createElement('div');
      header.className = 'ayah-header';

      const numCircle = document.createElement('div');
      numCircle.className = 'ayah-number-circle';
      numCircle.textContent = ayah.number;

      const modeTag = document.createElement('div');
      modeTag.className = 'ayah-mode-tag';
      modeTag.textContent = 'শুধু আরবি';

      header.appendChild(numCircle);
      header.appendChild(modeTag);
      card.appendChild(header);

      const lineEl = document.createElement('div');
      lineEl.className = 'ayah-line-ar';
      lineEl.textContent = ayah.arabicFull;
      card.appendChild(lineEl);

      const transEl = document.createElement('div');
      transEl.className = 'ayah-translation hidden';
      transEl.textContent = ayah.translation;
      card.appendChild(transEl);

      const grid = document.createElement('div');
      grid.className = 'word-grid hidden';

      if (ayah.words && ayah.words.length) {
        ayah.words.forEach(word => {
          const pill = document.createElement('div');
          pill.className = 'word-pill';

          const ar = document.createElement('div');
          ar.className = 'word-pill-ar';
          ar.textContent = word.text;

          const bn = document.createElement('div');
          bn.className = 'word-pill-bn';
          bn.textContent = word.meaningBn || '';

          pill.appendChild(ar);
          pill.appendChild(bn);

          pill.addEventListener('click', () => {
            if (!grammarEnabled) return;

            clearActiveWord();
            pill.classList.add('active');
            setGrammarDetails(word.text, word.meaningBn, word.notes || '');
          });

          grid.appendChild(pill);
        });
      }

      card.appendChild(grid);
      return card;
    }

    fetch('surah_104.json')
      .then(r => r.json())
      .then(data => {
        if (data.hasBismillah && data.bismillah) {
          bismillahAr.textContent = data.bismillah.arabic;
          bismillahBn.textContent = data.bismillah.bangla;
        }

        data.ayahs.forEach(ayah => {
          const card = createAyahCard(ayah);
          ayahContainer.appendChild(card);
        });

        updateViewToggles();
      })
      .catch(err => {
        console.error(err);
        bismillahBn.textContent =
          'ডেটা লোড করতে সমস্যা হচ্ছে। surah_104.json ফাইলটি একই ফোল্ডারে আছে কিনা দেখুন।';
      });
  </script>
</body>
</html>
