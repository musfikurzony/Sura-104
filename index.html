<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <title>AL-QUR'AN ‚Ä¢ Word by Word ‚Ä¢ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶∏‡¶π</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Basic styles -->
  <style>
    :root {
      --bg-main: #0b1120;
      --bg-panel: #111827;
      --bg-surface: #020617;
      --bg-surface-soft: #0f172a;
      --accent: #22c55e;
      --accent-soft: rgba(34, 197, 94, 0.08);
      --accent-strong: rgba(34, 197, 94, 0.2);
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --border-soft: #1f2937;
      --border-strong: #22c55e;
      --danger: #fb7185;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #0f172a 0, #020617 50%, #000 100%);
      color: var(--text-main);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    button {
      font-family: inherit;
      cursor: pointer;
    }

    /* Top App Bar */
    .app-bar {
      position: sticky;
      top: 0;
      z-index: 40;
      backdrop-filter: blur(10px);
      background: linear-gradient(to right, rgba(15, 23, 42, 0.88), rgba(8, 47, 35, 0.92));
      border-bottom: 1px solid rgba(15, 118, 110, 0.4);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
    }

    .app-bar-inner {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0.6rem 1rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.75rem;
    }

    .app-title {
      display: flex;
      align-items: center;
      gap: 0.65rem;
      font-size: 0.95rem;
    }

    .app-title-icon {
      width: 30px;
      height: 30px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, #a7f3d0, #22c55e 40%, #064e3b 80%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.1rem;
      box-shadow: 0 0 0 1px rgba(16, 185, 129, 0.7), 0 10px 25px rgba(16, 185, 129, 0.45);
    }

    .app-title-text {
      display: flex;
      flex-direction: column;
      gap: 0.05rem;
    }

    .app-title-main {
      font-weight: 600;
      letter-spacing: 0.04em;
      font-size: 0.9rem;
    }

    .app-title-sub {
      font-size: 0.75rem;
      color: #a5b4fc;
    }

    .app-current-surah {
      flex: 1;
      text-align: center;
      font-size: 0.85rem;
      color: #e5e7eb;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .app-actions {
      display: flex;
      align-items: center;
      gap: 0.35rem;
    }

    .icon-btn {
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.7));
      padding: 0.35rem 0.55rem;
      display: flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 0.75rem;
      color: #e5e7eb;
    }

    .icon-btn span.icon {
      font-size: 1rem;
    }

    .icon-btn-primary {
      border-color: rgba(34, 197, 94, 0.7);
      background: radial-gradient(circle at top, rgba(16, 185, 129, 0.2), rgba(4, 47, 46, 0.9));
      box-shadow: 0 0 0 1px rgba(45, 212, 191, 0.6), 0 10px 25px rgba(34, 197, 94, 0.4);
    }

    .icon-btn-primary:hover {
      background: radial-gradient(circle at top, rgba(22, 163, 74, 0.4), rgba(2, 44, 34, 0.95));
    }

    /* Layout */
    .app-main {
      flex: 1;
      max-width: 1100px;
      margin: 0.75rem auto 1.25rem;
      padding: 0 0.75rem 1.5rem;
      display: grid;
      grid-template-columns: minmax(0, 2.1fr) minmax(260px, 1.4fr);
      gap: 1rem;
    }

    @media (max-width: 840px) {
      .app-main {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    /* Panels */
    .panel {
      border-radius: 1.25rem;
      background: radial-gradient(circle at top left, rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.98));
      border: 1px solid rgba(30, 64, 175, 0.5);
      box-shadow:
        0 18px 50px rgba(15, 23, 42, 0.95),
        0 0 0 1px rgba(15, 23, 42, 0.8);
      overflow: hidden;
      position: relative;
    }

    .panel-header {
      padding: 0.8rem 1rem 0.5rem;
      border-bottom: 1px solid rgba(31, 41, 55, 0.9);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.6rem;
    }

    .panel-title {
      font-size: 0.85rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .panel-title-icon {
      width: 22px;
      height: 22px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 20%, #a5b4fc, #4f46e5);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      box-shadow: 0 0 0 1px rgba(129, 140, 248, 0.6);
    }

    .panel-subtitle {
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .panel-body {
      padding: 0.7rem 0.7rem 0.9rem;
      max-height: calc(100vh - 140px);
      overflow: auto;
      scroll-behavior: smooth;
    }

    @media (max-width: 840px) {
      .panel-body {
        max-height: none;
      }
    }

    /* Surah Selector / Controls */
    .selector-row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 0.5rem;
      padding: 0.4rem 0.15rem 0.6rem;
      border-bottom: 1px dashed rgba(31, 41, 55, 0.9);
      margin: 0 0.5rem 0.4rem;
    }

    .selector-label {
      font-size: 0.8rem;
      color: var(--text-muted);
      display: flex;
      align-items: center;
      gap: 0.35rem;
    }

    .selector-label span.icon {
      font-size: 1rem;
    }

    .selector-control {
      display: flex;
      align-items: center;
      gap: 0.4rem;
      flex: 1;
      min-width: 180px;
    }

    .select-surah {
      flex: 1;
      border-radius: 999px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.85), rgba(15, 23, 42, 0.98));
      padding: 0.35rem 0.8rem;
      color: var(--text-main);
      font-size: 0.85rem;
      appearance: none;
      position: relative;
    }

    .select-surah:focus {
      outline: none;
      border-color: rgba(34, 197, 94, 0.9);
      box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.4);
    }

    .mode-tabs {
      display: inline-flex;
      align-items: center;
      border-radius: 999px;
      padding: 0.15rem;
      background: radial-gradient(circle at top left, rgba(15, 23, 42, 1), rgba(15, 23, 42, 0.95));
      border: 1px solid rgba(55, 65, 81, 0.9);
      box-shadow: 0 10px 30px rgba(15, 23, 42, 0.85);
    }

    .mode-tab {
      border-radius: 999px;
      border: none;
      padding: 0.35rem 0.65rem;
      font-size: 0.78rem;
      color: var(--text-muted);
      background: transparent;
      display: flex;
      align-items: center;
      gap: 0.3rem;
      white-space: nowrap;
    }

    .mode-tab span.icon {
      font-size: 0.9rem;
    }

    .mode-tab.active {
      background: radial-gradient(circle at top, rgba(34, 197, 94, 0.3), rgba(5, 46, 22, 0.95));
      color: #ecfdf5;
      box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.8);
    }

    .mode-tab:not(.active):hover {
      background: rgba(30, 64, 175, 0.35);
      color: #e5e7eb;
    }

    @media (max-width: 640px) {
      .mode-tabs {
        width: 100%;
        justify-content: space_between;
        justify-content: space-between;
      }

      .mode-tab {
        flex: 1;
        justify-content: center;
      }
    }

    /* Ayah Display */
    .surah-meta {
      padding: 0.4rem 0.2rem 0.2rem;
      margin: 0 0.4rem 0.4rem;
      border-radius: 0.75rem;
      background: linear-gradient(to right, rgba(15, 23, 42, 0.95), rgba(22, 163, 74, 0.20));
      border: 1px solid rgba(55, 65, 81, 0.9);
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.78rem;
    }

    .surah-meta-main {
      flex: 1;
      min-width: 120px;
    }

    .surah-meta-main .name-ar {
      font-family: "Scheherazade New", "Amiri", serif;
      font-size: 1.05rem;
    }

    .surah-meta-main .name-bn {
      font-size: 0.8rem;
      color: #e5e7eb;
    }

    .surah-meta-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.35rem;
    }

    .pill {
      border-radius: 999px;
      padding: 0.15rem 0.55rem;
      border: 1px solid rgba(55, 65, 81, 0.9);
      font-size: 0.72rem;
      color: #e5e7eb;
      background: rgba(15, 23, 42, 0.95);
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
    }

    .pill-accent {
      border-color: rgba(34, 197, 94, 0.8);
      background: radial-gradient(circle at top, rgba(34, 197, 94, 0.2), rgba(5, 46, 22, 0.95));
    }

    .pill span.icon {
      font-size: 0.9rem;
    }

    /* Bismillah */
    .bismillah-block {
      text-align: center;
      padding: 0.6rem 0.3rem 0.45rem;
      margin: 0 0.4rem 0.3rem;
      border-radius: 0.9rem;
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.99));
      border: 1px dashed rgba(55, 65, 81, 0.9);
    }

    .bismillah-ar {
      font-family: "Scheherazade New", "Amiri", serif;
      font-size: 1.2rem;
      margin-bottom: 0.35rem;
    }

    .bismillah-bn {
      font-size: 0.8rem;
      color: var(--text-main);
      margin-bottom: 0.25rem;
    }

    .bismillah-trans {
      font-size: 0.78rem;
      color: var(--text-muted);
    }

    .bismillah-trans div {
      margin-top: 0.18rem;
    }

    /* Ayah Cards */
    .ayah-card {
      margin: 0.4rem 0.4rem 0.2rem;
      padding: 0.6rem 0.6rem 0.55rem;
      border-radius: 0.85rem;
      background: radial-gradient(circle at top left, rgba(15, 23, 42, 0.98), rgba(15, 23, 42, 0.96));
      border: 1px solid rgba(31, 41, 55, 0.95);
      position: relative;
      overflow: hidden;
    }

    .ayah-card::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at top right, rgba(34, 197, 94, 0.085), transparent 60%);
      opacity: 0.9;
      pointer-events: none;
    }

    .ayah-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 0.35rem;
    }

    .ayah-number {
      width: 26px;
      height: 26px;
      border-radius: 999px;
      border: 1px solid rgba(55, 65, 81, 0.95);
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.95), rgba(15, 23, 42, 1));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      color: #e5e7eb;
    }

    .ayah-meta {
      font-size: 0.72rem;
      color: var(--text-muted);
      display: flex;
      gap: 0.4rem;
      align-items: center;
    }

    .ayah-text-ar {
      font-family: "Scheherazade New", "Amiri", serif;
      font-size: 1.05rem;
      line-height: 2.0;
      direction: rtl;
      text-align: right;
      margin-top: 0.2rem;
      margin-bottom: 0.25rem;
    }

    .ayah-text-bn {
      font-size: 0.82rem;
      line-height: 1.6;
      margin-top: 0.25rem;
      color: var(--text-main);
    }

    .ayah-translations {
      margin-top: 0.25rem;
      padding-top: 0.25rem;
      border-top: 1px dashed rgba(31, 41, 55, 0.95);
      font-size: 0.78rem;
      color: var(--text-muted);
    }

    .ayah-translations div + div {
      margin-top: 0.18rem;
    }

    .ayah-trans-label {
      font-size: 0.74rem;
      color: #a5b4fc;
      margin-right: 0.35rem;
    }

    /* Word-by-word Arabic tokens */
    .word-token {
      display: inline-block;
      padding: 0.05rem 0.35rem;
      margin: 0.10rem 0.12rem;
      border-radius: 0.9rem;
      border: 1px solid transparent;
      cursor: pointer;
      font-size: 1.0rem;
      transition: background 0.12s ease, transform 0.05s ease, border-color 0.12s ease;
    }

    .word-token:hover {
      background: rgba(34, 197, 94, 0.15);
      border-color: rgba(34, 197, 94, 0.7);
      transform: translateY(-1px);
    }

    .word-token.active {
      background: radial-gradient(circle at top, rgba(34, 197, 94, 0.35), rgba(5, 46, 22, 0.95));
      border-color: rgba(34, 197, 94, 0.95);
      color: #ecfdf5;
      box-shadow: 0 0 0 1px rgba(22, 163, 74, 0.9);
    }

    /* Word Modal (center popup) */
    .word-modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.65);
      backdrop-filter: blur(7px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 60;
    }

    .word-modal {
      width: min(480px, 92vw);
      max-height: 70vh;
      border-radius: 1rem;
      background: radial-gradient(circle at top left, #020617, #020617 40%, #020617 100%);
      border: 1px solid rgba(55, 65, 81, 0.95);
      box-shadow:
        0 22px 55px rgba(0, 0, 0, 0.85),
        0 0 0 1px rgba(15, 23, 42, 0.9);
      padding: 0.75rem 0.85rem 0.85rem;
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .word-modal::before {
      content: "";
      position: absolute;
      inset: 0;
      background:
        radial-gradient(circle at top left, rgba(56, 189, 248, 0.18), transparent 55%),
        radial-gradient(circle at bottom right, rgba(34, 197, 94, 0.18), transparent 55%);
      opacity: 0.9;
      pointer-events: none;
    }

    .word-modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.5rem;
      position: relative;
      z-index: 1;
    }

    .word-modal-mainlabel {
      display: flex;
      flex-direction: column;
      gap: 0.1rem;
    }

    .word-modal-mainlabel .arabic {
      font-family: "Scheherazade New", "Amiri", serif;
      font-size: 1.1rem;
      text-align: right;
    }

    .word-modal-mainlabel .ayah-ref {
      font-size: 0.75rem;
      color: #9ca3af;
      text-align: left;
    }

    .word-modal-close {
      border-radius: 999px;
      border: 1px solid rgba(75, 85, 99, 0.95);
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.96), rgba(15, 23, 42, 1));
      width: 26px;
      height: 26px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.95rem;
      color: #9ca3af;
    }

    .word-modal-close:hover {
      border-color: rgba(248, 113, 113, 0.9);
      color: #fecaca;
    }

    .word-modal-body {
      display: grid;
      grid-template-columns: minmax(0, 1.4fr) minmax(0, 1.6fr);
      gap: 0.6rem;
      position: relative;
      z-index: 1;
    }

    @media (max-width: 600px) {
      .word-modal-body {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .word-modal-section {
      border-radius: 0.75rem;
      padding: 0.5rem;
      background: radial-gradient(circle at top left, rgba(15, 23, 42, 0.98), rgba(17, 24, 39, 1));
      border: 1px solid rgba(30, 64, 175, 0.7);
      font-size: 0.8rem;
    }

    .word-modal-section h4 {
      margin: 0 0 0.3rem;
      font-size: 0.75rem;
      color: #a5b4fc;
      display: flex;
      align-items: center;
      gap: 0.3rem;
    }

    .word-modal-section h4 span.icon {
      font-size: 0.85rem;
    }

    .word-modal-meaning-text {
      font-size: 0.82rem;
      color: #e5e7eb;
      line-height: 1.6;
    }

    .word-modal-notes {
      max-height: 32vh;
      overflow: auto;
      font-size: 0.78rem;
      color: #e5e7eb;
      line-height: 1.6;
      padding-right: 0.35rem;
    }

    /* Sidebar: Surah list & Settings */
    .sidebar-section {
      padding: 0.55rem 0.65rem 0.7rem;
      border-bottom: 1px solid rgba(31, 41, 55, 0.95);
    }

    .sidebar-title {
      font-size: 0.8rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.4rem;
      margin-bottom: 0.3rem;
    }

    .sidebar-title span.icon {
      font-size: 1rem;
    }

    .surah-list {
      max-height: 260px;
      overflow: auto;
      padding-right: 0.2rem;
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 0.25rem;
      font-size: 0.78rem;
    }

    @media (max-width: 840px) {
      .surah-list {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    @media (max-width: 640px) {
      .surah-list {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    .surah-chip {
      border-radius: 999px;
      padding: 0.18rem 0.45rem;
      border: 1px solid rgba(55, 65, 81, 0.95);
      background: radial-gradient(circle at top, rgba(15, 23, 42, 1), rgba(15, 23, 42, 0.98));
      display: flex;
      align-items: center;
      gap: 0.25rem;
      cursor: pointer;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .surah-chip-number {
      font-size: 0.75rem;
      color: #9ca3af;
    }

    .surah-chip-name {
      font-size: 0.78rem;
      color: #e5e7eb;
    }

    .surah-chip.active {
      border-color: rgba(34, 197, 94, 0.95);
      background: radial-gradient(circle at top, rgba(34, 197, 94, 0.35), rgba(5, 46, 22, 0.95));
      color: #ecfdf5;
    }

    .surah-chip:hover {
      border-color: rgba(59, 130, 246, 0.9);
    }

    .settings-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 0.5rem;
      font-size: 0.78rem;
    }

    @media (max-width: 640px) {
      .settings-grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .settings-field {
      border-radius: 0.75rem;
      padding: 0.4rem 0.5rem;
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.98), rgba(15, 23, 42, 1));
      border: 1px solid rgba(31, 41, 55, 0.95);
    }

    .settings-label {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-bottom: 0.25rem;
    }

    .settings-input {
      width: 100%;
      font-size: 0.8rem;
      padding: 0.25rem 0.4rem;
      border-radius: 0.45rem;
      border: 1px solid rgba(55, 65, 81, 0.95);
      background: rgba(15, 23, 42, 1);
      color: var(--text-main);
    }

    .settings-input:focus {
      outline: none;
      border-color: rgba(34, 197, 94, 0.85);
    }

    .checkbox-row {
      display: flex;
      align-items: center;
      gap: 0.35rem;
      font-size: 0.78rem;
    }

    .checkbox-row input[type="checkbox"] {
      width: 14px;
      height: 14px;
      accent-color: #22c55e;
    }

    .writer-list {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
      font-size: 0.78rem;
    }

    .writer-item {
      display: flex;
      align-items: center;
      gap: 0.35rem;
    }

    .writer-item input[type="checkbox"] {
      width: 14px;
      height: 14px;
      accent-color: #22c55e;
    }

    .writer-name {
      color: #e5e7eb;
    }

    .writer-note {
      font-size: 0.7rem;
      color: #9ca3af;
    }

    /* Bottom bar for mobile (quick controls) */
    .bottom-bar {
      position: sticky;
      bottom: 0;
      z-index: 35;
      padding: 0.35rem 0.65rem 0.5rem;
      background: linear-gradient(to top, rgba(15, 23, 42, 0.98), rgba(15, 23, 42, 0.9));
      border-top: 1px solid rgba(31, 41, 55, 0.95);
      display: none;
    }

    .bottom-bar-inner {
      max-width: 1100px;
      margin: 0 auto;
      display: flex;
      gap: 0.4rem;
    }

    .bottom-bar-btn {
      flex: 1;
      border-radius: 999px;
      padding: 0.35rem 0.4rem;
      border: 1px solid rgba(55, 65, 81, 0.95);
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.98), rgba(15, 23, 42, 1));
      font-size: 0.75rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.3rem;
      color: #e5e7eb;
    }

    .bottom-bar-btn span.icon {
      font-size: 0.9rem;
    }

    .bottom-bar-btn-primary {
      border-color: rgba(34, 197, 94, 0.85);
      background: radial-gradient(circle at top, rgba(34, 197, 94, 0.32), rgba(5, 46, 22, 0.95));
    }

    @media (max-width: 840px) {
      .bottom-bar {
        display: block;
      }
    }

    /* Info panel */
    .info-block {
      padding: 0.45rem 0.55rem 0.5rem;
      font-size: 0.78rem;
      color: var(--text-muted);
      line-height: 1.5;
    }

    .info-block strong {
      color: #e5e7eb;
    }

    /* ========== NEW: Floating Settings Button + Panel ========== */

    .floating-settings-toggle {
      position: fixed;
      right: 1.1rem;
      bottom: 4.2rem;
      z-index: 55;
      width: 44px;
      height: 44px;
      border-radius: 999px;
      border: 1px solid rgba(34, 197, 94, 0.8);
      background: radial-gradient(circle at top, rgba(34, 197, 94, 0.25), rgba(5, 46, 22, 0.95));
      box-shadow:
        0 10px 30px rgba(15, 23, 42, 0.95),
        0 0 0 1px rgba(15, 23, 42, 0.9);
      font-size: 1.3rem;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #ecfdf5;
    }

    .floating-settings-toggle:hover {
      transform: translateY(-1px);
      box-shadow:
        0 16px 40px rgba(15, 23, 42, 1),
        0 0 0 1px rgba(34, 197, 94, 0.9);
    }

    .floating-settings-panel {
      position: fixed;
      right: 1.1rem;
      bottom: 9rem;
      width: min(320px, 90vw);
      max-height: 70vh;
      border-radius: 1rem;
      background: radial-gradient(circle at top left, rgba(15, 23, 42, 0.98), rgba(15, 23, 42, 1));
      border: 1px solid rgba(34, 197, 94, 0.7);
      box-shadow:
        0 20px 45px rgba(0, 0, 0, 0.9),
        0 0 0 1px rgba(15, 23, 42, 0.9);
      padding: 0.6rem 0.7rem 0.7rem;
      z-index: 56;
      display: none;
      flex-direction: column;
      gap: 0.4rem;
      font-size: 0.78rem;
      overflow: hidden;
    }

    .floating-settings-panel.open {
      display: flex;
    }

    .floating-settings-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.4rem;
      margin-bottom: 0.2rem;
    }

    .floating-settings-title {
      display: flex;
      align-items: center;
      gap: 0.35rem;
      font-size: 0.8rem;
      font-weight: 600;
    }

    .floating-settings-title span.icon {
      font-size: 1rem;
    }

    .floating-settings-close {
      border-radius: 999px;
      border: 1px solid rgba(75, 85, 99, 0.95);
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.96), rgba(15, 23, 42, 1));
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      color: #9ca3af;
    }

    .floating-settings-close:hover {
      border-color: rgba(248, 113, 113, 0.9);
      color: #fecaca;
    }

    .floating-settings-body {
      margin-top: 0.2rem;
      padding-top: 0.2rem;
      border-top: 1px dashed rgba(31, 41, 55, 0.9);
      overflow: auto;
    }

    .floating-settings-group-title {
      font-size: 0.76rem;
      color: #a5b4fc;
      margin: 0.2rem 0 0.1rem;
    }

    .floating-settings-row {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 0.35rem;
      margin-bottom: 0.25rem;
    }

    .floating-settings-field {
      border-radius: 0.55rem;
      padding: 0.3rem 0.4rem;
      background: rgba(15, 23, 42, 0.98);
      border: 1px solid rgba(31, 41, 55, 0.95);
    }

    .floating-settings-field label {
      display: block;
      font-size: 0.73rem;
      color: var(--text-muted);
      margin-bottom: 0.15rem;
    }

    .floating-settings-input {
      width: 100%;
      font-size: 0.78rem;
      padding: 0.18rem 0.3rem;
      border-radius: 0.35rem;
      border: 1px solid rgba(55, 65, 81, 0.95);
      background: rgba(15, 23, 42, 1);
      color: var(--text-main);
    }

    .floating-settings-input:focus {
      outline: none;
      border-color: rgba(34, 197, 94, 0.85);
    }

    .floating-writer-list {
      margin-top: 0.15rem;
      display: flex;
      flex-direction: column;
      gap: 0.2rem;
    }

    .floating-writer-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.35rem;
      font-size: 0.76rem;
    }

    .floating-writer-item span {
      color: #e5e7eb;
    }

    .floating-writer-item input[type="checkbox"] {
      width: 14px;
      height: 14px;
      accent-color: #22c55e;
    }

    @media (max-width: 640px) {
      .floating-settings-toggle {
        right: 0.8rem;
        bottom: 4.5rem;
      }

      .floating-settings-panel {
        right: 0.6rem;
        bottom: 9rem;
        width: min(95vw, 360px);
      }
    }
  </style>

  <script src="suras.js"></script>
</head>
<body>
  <!-- Word Modal -->
  <div id="wordModalBackdrop" class="word-modal-backdrop">
    <div class="word-modal">
      <div class="word-modal-header">
        <div class="word-modal-mainlabel">
          <div id="wordModalArabic" class="arabic"></div>
          <div id="wordModalAyahRef" class="ayah-ref"></div>
        </div>
        <button id="wordModalClose" class="word-modal-close" aria-label="Close">
          ‚úï
        </button>
      </div>
      <div class="word-modal-body">
        <div class="word-modal-section">
          <h4>
            <span class="icon">üî§</span>
            ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶∂‡¶¨‡ßç‡¶¶‡¶æ‡¶∞‡ßç‡¶•
          </h4>
          <div id="wordModalMeaning" class="word-modal-meaning-text"></div>
        </div>
        <div class="word-modal-section">
          <h4>
            <span class="icon">üìö</span>
            ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶∞‡¶£ ‡¶®‡ßã‡¶ü‡¶∏
          </h4>
          <div id="wordModalNotes" class="word-modal-notes"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Top App Bar -->
  <header class="app-bar">
    <div class="app-bar-inner">
      <div class="app-title">
        <div class="app-title-icon">üìñ</div>
        <div class="app-title-text">
          <div class="app-title-main">AL-QUR'AN</div>
          <div class="app-title-sub">Word-by-Word ‚Ä¢ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶∏‡¶π</div>
        </div>
      </div>
      <div id="currentSurahTitle" class="app-current-surah">
        ‡¶∏‡ßÇ‡¶∞‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® ‚Äî ‡ßß‚Äì‡ßß‡ßß‡ß™ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶•‡ßá‡¶ï‡ßá
      </div>
      <div class="app-actions">
        <button id="scrollTopBtn" class="icon-btn" type="button">
          <span class="icon">‚¨ÜÔ∏è</span>
        </button>
        <button id="openSettingsBtn" class="icon-btn icon-btn-primary" type="button">
          <span class="icon">‚öôÔ∏è</span>
          <span>‡¶´‡¶®‡ßç‡¶ü & ‡¶≠‡¶ø‡¶â</span>
        </button>
      </div>
    </div>
  </header>

  <!-- Main Layout -->
  <main class="app-main">
    <!-- Reader Panel -->
    <section class="panel" id="readerPanel">
      <div class="panel-header">
        <div>
          <div class="panel-title">
            <div class="panel-title-icon">üìñ</div>
            <span>‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶® ‡¶∞‡¶ø‡¶°‡¶æ‡¶∞</span>
          </div>
          <div class="panel-subtitle">
            ‡¶∏‡ßÇ‡¶∞‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®, ‡¶§‡¶æ‡¶∞‡¶™‡¶∞ ‡¶∂‡¶¨‡ßç‡¶¶‡ßá‚Äì‡¶∂‡¶¨‡ßç‡¶¶‡ßá / ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶Ö‡¶®‡ßÅ‡¶¨‡¶æ‡¶¶ ‡¶Ø‡ßá ‡¶Æ‡ßã‡¶°‡ßá ‡¶ö‡¶æ‡¶á‡¶¨‡ßá‡¶® ‡¶∏‡ßá‡¶ü‡¶ø ‡¶¨‡ßá‡¶õ‡ßá ‡¶®‡¶ø‡¶®‡•§
          </div>
        </div>
      </div>

      <div class="panel-body">
        <!-- Surah & Mode selectors -->
        <div class="selector-row">
          <div class="selector-label">
            <span class="icon">üïã</span>
            <span>‡¶∏‡ßÇ‡¶∞‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶®</span>
          </div>
          <div class="selector-control">
            <select id="surahSelect" class="select-surah">
              <option value="">‚Äî ‡ßß‚Äì‡ßß‡ßß‡ß™ ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡ßÇ‡¶∞‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® ‚Äî</option>
            </select>
          </div>
        </div>

        <div class="selector-row" style="margin-top: 0.35rem;">
          <div class="selector-label">
            <span class="icon">üéõÔ∏è</span>
            <span>‡¶™‡ßú‡¶æ‡¶∞ ‡¶Æ‡ßã‡¶°</span>
          </div>
          <div class="selector-control" style="justify-content: flex-start;">
            <div class="mode-tabs">
              <button class="mode-tab active" data-mode="word" id="modeWordBtn" type="button">
                <span class="icon">üî§</span>
                <span>‡¶∂‡¶¨‡ßç‡¶¶‡ßá‚Äì‡¶∂‡¶¨‡ßç‡¶¶‡ßá</span>
              </button>
              <button class="mode-tab" data-mode="translation" id="modeTransBtn" type="button">
                <span class="icon">üìò</span>
                <span>‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶Ö‡¶®‡ßÅ‡¶¨‡¶æ‡¶¶</span>
              </button>
              <button class="mode-tab" data-mode="arabic" id="modeArabicBtn" type="button">
                <span class="icon">üïã</span>
                <span>‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶Ü‡¶∞‡¶¨‡¶ø</span>
              </button>
            </div>
          </div>
        </div>

        <!-- Surah Content -->
        <div id="surahContent">
          <div class="info-block">
            <strong>‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶¨‡ßá‡¶®?</strong><br />
            ‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶•‡ßá‡¶ï‡ßá ‡¶Ø‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡ßÇ‡¶∞‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ ‡¶§‡¶æ‡¶∞‡¶™‡¶∞ <strong>‡¶∂‡¶¨‡ßç‡¶¶‡ßá‚Äì‡¶∂‡¶¨‡ßç‡¶¶‡ßá</strong> ‡¶Æ‡ßã‡¶°‡ßá
            ‡¶ó‡¶ø‡ßü‡ßá ‡¶Ü‡¶∞‡¶¨‡¶ø ‡¶∂‡¶¨‡ßç‡¶¶‡ßá ‡¶ü‡ßç‡¶Ø‡¶æ‡¶™ ‡¶ï‡¶∞‡¶≤‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∏‡ßÅ‡¶®‡ßç‡¶¶‡¶∞ popup‚Äì‡¶è ‡¶∂‡¶¨‡ßç‡¶¶‡ßá‡¶∞ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶Ö‡¶∞‡ßç‡¶• ‡¶ì ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶∞‡¶£ ‡¶®‡ßã‡¶ü‡¶∏ ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶™‡¶æ‡¶¨‡ßá‡¶®‡•§
            <br /><br />
            <strong>‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶Ö‡¶®‡ßÅ‡¶¨‡¶æ‡¶¶</strong> ‡¶Æ‡ßã‡¶°‡ßá ‡¶ö‡¶æ‡¶á‡¶≤‡ßá ‡¶è‡¶ï‡¶æ‡¶ß‡¶ø‡¶ï ‡¶≤‡ßá‡¶ñ‡¶ï (‡¶§‡¶æ‡¶´‡¶∏‡ßÄ‡¶∞‡ßá ‡¶ì‡¶∏‡¶Æ‡¶æ‡¶®‡ßÄ, ‡¶§‡¶æ‡¶ì‡¶Ø‡ßÄ‡¶π‡ßÅ‡¶≤ ‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶®)
            ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßá ‡¶§‡ßÅ‡¶≤‡¶®‡¶æ ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡¶®‡•§<br />
            ‡¶∏‡¶¨ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ (‡¶´‡¶®‡ßç‡¶ü ‡¶∏‡¶æ‡¶á‡¶ú, line height ‡¶á‡¶§‡ßç‡¶Ø‡¶æ‡¶¶‡¶ø) ‡¶°‡¶æ‡¶® ‡¶™‡¶æ‡¶∂‡ßá‡¶∞ <strong>‡¶´‡¶®‡ßç‡¶ü & ‡¶≠‡¶ø‡¶â</strong> ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶•‡ßá‡¶ï‡ßá
            ‡¶®‡¶ø‡ßü‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá, ‡¶Ü‡¶∞ ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶ø‡¶ö‡ßá ‡¶≠‡¶æ‡¶∏‡¶Æ‡¶æ‡¶® ‚öôÔ∏è ‡¶¨‡¶æ‡¶ü‡¶® ‡¶•‡ßá‡¶ï‡ßá‡¶ì ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§
          </div>
        </div>
      </div>
    </section>

    <!-- Sidebar Panel -->
    <aside class="panel" id="sidebarPanel">
      <div class="panel-header">
        <div>
          <div class="panel-title">
            <div class="panel-title-icon">üìö</div>
            <span>‡¶∏‡ßÇ‡¶∞‡¶æ‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ & ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏</span>
          </div>
          <div class="panel-subtitle">
            ‡ßß‚Äì‡ßß‡ßß‡ß™ ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶∏‡¶¨ ‡¶∏‡ßÇ‡¶∞‡¶æ ‚Äî ‡¶Ø‡¶æ‡¶∞ JSON data ‡¶•‡¶æ‡¶ï‡¶¨‡ßá, ‡¶∏‡ßá‡¶ü‡¶ø ‡¶™‡ßú‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§
          </div>
        </div>
      </div>

      <div class="panel-body">
        <!-- Surah List -->
        <div class="sidebar-section">
          <div class="sidebar-title">
            <span class="icon">üïã</span>
            <span>‡¶∏‡ßÇ‡¶∞‡¶æ ‡ßß‚Äì‡ßß‡ßß‡ß™</span>
          </div>
          <div id="surahList" class="surah-list">
            <!-- JS ‡¶¶‡¶ø‡ßü‡ßá ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶π‡¶¨‡ßá -->
          </div>
        </div>

        <!-- Settings -->
        <div class="sidebar-section" id="settingsPanel">
          <div class="sidebar-title">
            <span class="icon">‚öôÔ∏è</span>
            <span>‡¶´‡¶®‡ßç‡¶ü & ‡¶≠‡¶ø‡¶â ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç</span>
          </div>
          <div class="settings-grid">
            <div class="settings-field">
              <div class="settings-label">‡¶Ü‡¶∞‡¶¨‡¶ø ‡¶´‡¶®‡ßç‡¶ü ‡¶∏‡¶æ‡¶á‡¶ú</div>
              <input
                id="arabicFontSizeInput"
                class="settings-input"
                type="number"
                min="16"
                max="40"
                value="21"
              />
            </div>
            <div class="settings-field">
              <div class="settings-label">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶´‡¶®‡ßç‡¶ü ‡¶∏‡¶æ‡¶á‡¶ú</div>
              <input
                id="banglaFontSizeInput"
                class="settings-input"
                type="number"
                min="12"
                max="26"
                value="14"
              />
            </div>
            <div class="settings-field">
              <div class="settings-label">‡¶Ü‡¶∞‡¶¨‡¶ø line height</div>
              <input
                id="arabicLineHeightInput"
                class="settings-input"
                type="number"
                min="1.4"
                max="3"
                step="0.1"
                value="2.0"
              />
            </div>
            <div class="settings-field">
              <div class="settings-label">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ line height</div>
              <input
                id="banglaLineHeightInput"
                class="settings-input"
                type="number"
                min="1.2"
                max="2.4"
                step="0.1"
                value="1.6"
              />
            </div>

            <!-- NEW: word-by-word & popup font controls -->
            <div class="settings-field">
              <div class="settings-label">üéõÔ∏è ‡¶∂‡¶¨‡ßç‡¶¶‡ßá‚Äì‡¶∂‡¶¨‡ßç‡¶¶‡ßá ‡¶Ü‡¶∞‡¶¨‡¶ø ‡¶´‡¶®‡ßç‡¶ü</div>
              <input
                id="wordArabicFontSizeInput"
                class="settings-input"
                type="number"
                min="18"
                max="40"
                value="24"
              />
            </div>
            <div class="settings-field">
              <div class="settings-label">üî§ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶∂‡¶¨‡ßç‡¶¶‡¶æ‡¶∞‡ßç‡¶• ‡¶´‡¶®‡ßç‡¶ü</div>
              <input
                id="wordMeaningFontSizeInput"
                class="settings-input"
                type="number"
                min="12"
                max="26"
                value="15"
              />
            </div>
            <div class="settings-field">
              <div class="settings-label">üìö ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶∞‡¶£ ‡¶®‡ßã‡¶ü‡¶∏ ‡¶´‡¶®‡ßç‡¶ü</div>
              <input
                id="wordNotesFontSizeInput"
                class="settings-input"
                type="number"
                min="12"
                max="26"
                value="14"
              />
            </div>
          </div>

          <div style="margin-top: 0.6rem;">
            <div class="settings-label">‡¶Ö‡¶®‡ßÅ‡¶¨‡¶æ‡¶¶ ‡¶≤‡ßá‡¶ñ‡¶ï ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶®</div>
            <div class="writer-list">
              <label class="writer-item">
                <input type="checkbox" id="writerOsmani" checked />
                <div>
                  <div class="writer-name">‡¶§‡¶æ‡¶´‡¶∏‡ßÄ‡¶∞‡ßá ‡¶ì‡¶∏‡¶Æ‡¶æ‡¶®‡ßÄ</div>
                  <div class="writer-note">‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü ‡¶≠‡¶æ‡¶¨‡ßá ‡¶Ö‡¶® ‡¶•‡¶æ‡¶ï‡ßá</div>
                </div>
              </label>
              <label class="writer-item">
                <input type="checkbox" id="writerTawjih" checked />
                <div>
                  <div class="writer-name">‡¶§‡¶æ‡¶ì‡¶Ø‡ßÄ‡¶π‡ßÅ‡¶≤ ‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶®</div>
                  <div class="writer-note">‡¶Æ‡ßÅ‡¶´‡¶§‡¶ø ‡¶§‡¶æ‡¶ï‡ßÄ ‡¶â‡¶∏‡¶Æ‡¶æ‡¶®‡ßÄ (‡¶¶‡¶æ.‡¶¨‡¶æ.) ‡¶Ö‡¶¨‡¶≤‡¶Æ‡ßç‡¶¨‡¶®‡ßá</div>
                </div>
              </label>
            </div>
          </div>
        </div>

        <!-- Info -->
        <div class="sidebar-section">
          <div class="sidebar-title">
            <span class="icon">‚ÑπÔ∏è</span>
            <span>‡¶™‡ßç‡¶∞‡¶ø‡¶≠‡¶ø‡¶â ‡¶§‡¶•‡ßç‡¶Ø</span>
          </div>
          <div class="info-block">
            ‡¶è ‡¶ü‡ßÅ‡¶≤‡¶ü‡¶ø ‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø‡¶ó‡¶§ ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ ‡¶ì ‡¶§‡¶æ‡¶¶‡¶æ‡¶¨‡ßç‡¶¨‡ßÅ‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶ø‡¶∞‡ßç‡¶Æ‡¶ø‡¶§ ‡¶è‡¶ï‡¶ü‡¶ø
            <strong>‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡ßá‡¶ü ‡¶∏‡ßç‡¶ü‡¶æ‡¶°‡¶ø ‡¶™‡ßç‡¶∞‡¶ú‡ßá‡¶ï‡ßç‡¶ü</strong> ‚Äî ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ø‡ßã‡¶ó ‡¶π‡¶ì‡ßü‡¶æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶∏‡ßÇ‡¶∞‡¶æ‡¶∞ JSON data ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßÅ‡ßü‡¶æ‡¶≤‡¶ø
            ‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá ‡¶á‡¶®‡¶∂‡¶æ‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π, ‡¶Ø‡ßá‡¶® ‡¶∂‡¶¨‡ßç‡¶¶‡ßá‚Äì‡¶∂‡¶¨‡ßç‡¶¶‡ßá ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡¶æ‡¶∞ ‡¶®‡ßã‡¶ü‡¶∏‡¶ì ‡¶∏‡¶†‡¶ø‡¶ï ‡¶•‡¶æ‡¶ï‡ßá‡•§
          </div>
        </div>
      </div>
    </aside>
  </main>

  <!-- Bottom Bar (mobile quick controls) -->
  <div class="bottom-bar">
    <div class="bottom-bar-inner">
      <button id="bottomSurahBtn" class="bottom-bar-btn" type="button">
        <span class="icon">üïã</span>
        <span>‡¶∏‡ßÇ‡¶∞‡¶æ</span>
      </button>
      <button id="bottomWordBtn" class="bottom-bar-btn bottom-bar-btn-primary" type="button">
        <span class="icon">üî§</span>
        <span>‡¶∂‡¶¨‡ßç‡¶¶‡ßá‚Äì‡¶∂‡¶¨‡ßç‡¶¶‡ßá</span>
      </button>
      <button id="bottomTransBtn" class="bottom-bar-btn" type="button">
        <span class="icon">üìò</span>
        <span>‡¶Ö‡¶®‡ßÅ‡¶¨‡¶æ‡¶¶</span>
      </button>
      <button id="bottomSettingsBtn" class="bottom-bar-btn" type="button">
        <span class="icon">‚öôÔ∏è</span>
      </button>
    </div>
  </div>

  <!-- NEW: Floating Settings Button + Panel -->
  <button id="floatingSettingsToggle" class="floating-settings-toggle" type="button" aria-label="Quick font & view settings">
    ‚öôÔ∏è
  </button>

  <div id="floatingSettingsPanel" class="floating-settings-panel" tabindex="-1">
    <div class="floating-settings-header">
      <div class="floating-settings-title">
        <span class="icon">‚öôÔ∏è</span>
        <span>Quick ‡¶´‡¶®‡ßç‡¶ü & ‡¶≠‡¶ø‡¶â</span>
      </div>
      <button id="floatingSettingsClose" class="floating-settings-close" type="button">‚úï</button>
    </div>
    <div class="floating-settings-body">
      <div class="floating-settings-group-title">‡¶Ü‡¶∞‡¶¨‡¶ø & ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶´‡¶®‡ßç‡¶ü</div>
      <div class="floating-settings-row">
        <div class="floating-settings-field">
          <label for="floatArabicFontSizeInput">‡¶Ü‡¶∞‡¶¨‡¶ø ‡¶´‡¶®‡ßç‡¶ü</label>
          <input
            id="floatArabicFontSizeInput"
            class="floating-settings-input"
            type="number"
            min="16"
            max="40"
          />
        </div>
        <div class="floating-settings-field">
          <label for="floatBanglaFontSizeInput">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶´‡¶®‡ßç‡¶ü</label>
          <input
            id="floatBanglaFontSizeInput"
            class="floating-settings-input"
            type="number"
            min="12"
            max="26"
          />
        </div>
      </div>

      <div class="floating-settings-row">
        <div class="floating-settings-field">
          <label for="floatArabicLineHeightInput">‡¶Ü‡¶∞‡¶¨‡¶ø line</label>
          <input
            id="floatArabicLineHeightInput"
            class="floating-settings-input"
            type="number"
            min="1.4"
            max="3"
            step="0.1"
          />
        </div>
        <div class="floating-settings-field">
          <label for="floatBanglaLineHeightInput">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ line</label>
          <input
            id="floatBanglaLineHeightInput"
            class="floating-settings-input"
            type="number"
            min="1.2"
            max="2.4"
            step="0.1"
          />
        </div>
      </div>

      <div class="floating-settings-group-title">‡¶∂‡¶¨‡ßç‡¶¶‡ßá‚Äì‡¶∂‡¶¨‡ßç‡¶¶‡ßá & popup</div>
      <div class="floating-settings-row">
        <div class="floating-settings-field">
          <label for="floatWordArabicFontSizeInput">‡¶∂‡¶¨‡ßç‡¶¶‡ßá‚Äì‡¶∂‡¶¨‡ßç‡¶¶‡ßá ‡¶Ü‡¶∞‡¶¨‡¶ø</label>
          <input
            id="floatWordArabicFontSizeInput"
            class="floating-settings-input"
            type="number"
            min="18"
            max="40"
          />
        </div>
        <div class="floating-settings-field">
          <label for="floatWordMeaningFontSizeInput">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶∂‡¶¨‡ßç‡¶¶‡¶æ‡¶∞‡ßç‡¶•</label>
          <input
            id="floatWordMeaningFontSizeInput"
            class="floating-settings-input"
            type="number"
            min="12"
            max="26"
          />
        </div>
      </div>

      <div class="floating-settings-row">
        <div class="floating-settings-field">
          <label for="floatWordNotesFontSizeInput">‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶∞‡¶£ ‡¶®‡ßã‡¶ü‡¶∏</label>
          <input
            id="floatWordNotesFontSizeInput"
            class="floating-settings-input"
            type="number"
            min="12"
            max="26"
          />
        </div>
      </div>

      <div class="floating-settings-group-title">‡¶Ö‡¶®‡ßÅ‡¶¨‡¶æ‡¶¶ ‡¶≤‡ßá‡¶ñ‡¶ï</div>
      <div class="floating-settings-field">
        <div class="floating-writer-list">
          <label class="floating-writer-item">
            <span>‡¶§‡¶æ‡¶´‡¶∏‡ßÄ‡¶∞‡ßá ‡¶ì‡¶∏‡¶Æ‡¶æ‡¶®‡ßÄ</span>
            <input type="checkbox" id="floatWriterOsmani" />
          </label>
          <label class="floating-writer-item">
            <span>‡¶§‡¶æ‡¶ì‡¶Ø‡ßÄ‡¶π‡ßÅ‡¶≤ ‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶®</span>
            <input type="checkbox" id="floatWriterTawjih" />
          </label>
        </div>
      </div>
    </div>
  </div>

  <!-- Core Script -->
  <script>
    // ===== Global State =====
    const surahSelect = document.getElementById("surahSelect");
    const surahList = document.getElementById("surahList");
    const surahContent = document.getElementById("surahContent");
    const currentSurahTitle = document.getElementById("currentSurahTitle");

    const modeWordBtn = document.getElementById("modeWordBtn");
    const modeTransBtn = document.getElementById("modeTransBtn");
    const modeArabicBtn = document.getElementById("modeArabicBtn");
    const modeButtons = [modeWordBtn, modeTransBtn, modeArabicBtn];

    const writerOsmani = document.getElementById("writerOsmani");
    const writerTawjih = document.getElementById("writerTawjih");

    const arabicFontSizeInput = document.getElementById("arabicFontSizeInput");
    const banglaFontSizeInput = document.getElementById("banglaFontSizeInput");
    const arabicLineHeightInput = document.getElementById("arabicLineHeightInput");
    const banglaLineHeightInput = document.getElementById("banglaLineHeightInput");

    // NEW: separate word & popup font controls
    const wordArabicFontSizeInput = document.getElementById("wordArabicFontSizeInput");
    const wordMeaningFontSizeInput = document.getElementById("wordMeaningFontSizeInput");
    const wordNotesFontSizeInput = document.getElementById("wordNotesFontSizeInput");

    const scrollTopBtn = document.getElementById("scrollTopBtn");
    const openSettingsBtn = document.getElementById("openSettingsBtn");
    const settingsPanel = document.getElementById("settingsPanel");

    const bottomSurahBtn = document.getElementById("bottomSurahBtn");
    const bottomWordBtn = document.getElementById("bottomWordBtn");
    const bottomTransBtn = document.getElementById("bottomTransBtn");
    const bottomSettingsBtn = document.getElementById("bottomSettingsBtn");

    // Floating settings
    const floatingSettingsToggle = document.getElementById("floatingSettingsToggle");
    const floatingSettingsPanel = document.getElementById("floatingSettingsPanel");
    const floatingSettingsClose = document.getElementById("floatingSettingsClose");

    const floatArabicFontSizeInput = document.getElementById("floatArabicFontSizeInput");
    const floatBanglaFontSizeInput = document.getElementById("floatBanglaFontSizeInput");
    const floatArabicLineHeightInput = document.getElementById("floatArabicLineHeightInput");
    const floatBanglaLineHeightInput = document.getElementById("floatBanglaLineHeightInput");
    const floatWordArabicFontSizeInput = document.getElementById("floatWordArabicFontSizeInput");
    const floatWordMeaningFontSizeInput = document.getElementById("floatWordMeaningFontSizeInput");
    const floatWordNotesFontSizeInput = document.getElementById("floatWordNotesFontSizeInput");
    const floatWriterOsmani = document.getElementById("floatWriterOsmani");
    const floatWriterTawjih = document.getElementById("floatWriterTawjih");

    // Word Modal
    const wordModalBackdrop = document.getElementById("wordModalBackdrop");
    const wordModalClose = document.getElementById("wordModalClose");
    const wordModalArabic = document.getElementById("wordModalArabic");
    const wordModalAyahRef = document.getElementById("wordModalAyahRef");
    const wordModalMeaning = document.getElementById("wordModalMeaning");
    const wordModalNotes = document.getElementById("wordModalNotes");

    let currentMode = "word"; // "word" | "translation" | "arabic"
    let currentSurah = null; // will store loaded JSON
    let lastSurahNumber = null; // to control scroll on new surah only

    // ===== Helpers =====

    function setMode(mode) {
      currentMode = mode;
      modeButtons.forEach((btn) => {
        btn.classList.toggle("active", btn.dataset.mode === mode);
      });

      // bottom bar sync
      bottomWordBtn.classList.toggle("bottom-bar-btn-primary", mode === "word");
      bottomTransBtn.classList.toggle("bottom-bar-btn-primary", mode === "translation");
      renderCurrentSurah();
    }

    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    function toggleSettingsHighlight() {
      // ‡¶õ‡ßã‡¶ü visual cue
      settingsPanel.style.boxShadow = "0 0 0 1px rgba(34, 197, 94, 0.6)";
      settingsPanel.scrollIntoView({ behavior: "smooth", block: "center" });
      setTimeout(() => {
        settingsPanel.style.boxShadow = "none";
      }, 900);
    }

    function applyFontSettings() {
      const arSize = parseFloat(arabicFontSizeInput.value) || 21;
      const bnSize = parseFloat(banglaFontSizeInput.value) || 14;
      const arLH = parseFloat(arabicLineHeightInput.value) || 2.0;
      const bnLH = parseFloat(banglaLineHeightInput.value) || 1.6;

      const wordArSize = parseFloat(wordArabicFontSizeInput.value) || arSize;
      const wordMeaningSize = parseFloat(wordMeaningFontSizeInput.value) || bnSize;
      const wordNotesSize = parseFloat(wordNotesFontSizeInput.value) || bnSize;

      // Main ayah text (full ayah Arabic)
      document.querySelectorAll(".ayah-text-ar").forEach((el) => {
        el.style.fontSize = arSize + "px";
        el.style.lineHeight = arLH.toString();
      });

      // Main Bangla ayah translation
      document.querySelectorAll(".ayah-text-bn").forEach((el) => {
        el.style.fontSize = bnSize + "px";
        el.style.lineHeight = bnLH.toString();
      });

      // ‡¶∂‡¶¨‡ßç‡¶¶‡ßá‚Äì‡¶∂‡¶¨‡ßç‡¶¶‡ßá ‡¶Ü‡¶∞‡¶¨‡¶ø word tokens
      document.querySelectorAll(".word-token").forEach((el) => {
        el.style.fontSize = wordArSize + "px";
      });

      // Popup ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶∂‡¶¨‡ßç‡¶¶‡¶æ‡¶∞‡ßç‡¶•
      if (wordModalMeaning) {
        wordModalMeaning.style.fontSize = wordMeaningSize + "px";
        wordModalMeaning.style.lineHeight = "1.6";
      }

      // Popup ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶∞‡¶£ ‡¶®‡ßã‡¶ü‡¶∏
      if (wordModalNotes) {
        wordModalNotes.style.fontSize = wordNotesSize + "px";
        wordModalNotes.style.lineHeight = "1.6";
      }

      // sync values back to floating panel inputs
      syncSidebarToFloating();
    }

    function getSelectedWriters() {
      const writers = [];
      if (writerOsmani.checked) writers.push("osmani");
      if (writerTawjih.checked) writers.push("tawjih");
      return writers;
    }

    // ===== Floating settings sync helpers =====

    function syncSidebarToFloating() {
      // Font sizes & line heights
      floatArabicFontSizeInput.value = arabicFontSizeInput.value;
      floatBanglaFontSizeInput.value = banglaFontSizeInput.value;
      floatArabicLineHeightInput.value = arabicLineHeightInput.value;
      floatBanglaLineHeightInput.value = banglaLineHeightInput.value;
      floatWordArabicFontSizeInput.value = wordArabicFontSizeInput.value;
      floatWordMeaningFontSizeInput.value = wordMeaningFontSizeInput.value;
      floatWordNotesFontSizeInput.value = wordNotesFontSizeInput.value;

      // Writers
      floatWriterOsmani.checked = writerOsmani.checked;
      floatWriterTawjih.checked = writerTawjih.checked;
    }

    function syncFloatingToSidebar() {
      if (floatArabicFontSizeInput.value !== "") {
        arabicFontSizeInput.value = floatArabicFontSizeInput.value;
      }
      if (floatBanglaFontSizeInput.value !== "") {
        banglaFontSizeInput.value = floatBanglaFontSizeInput.value;
      }
      if (floatArabicLineHeightInput.value !== "") {
        arabicLineHeightInput.value = floatArabicLineHeightInput.value;
      }
      if (floatBanglaLineHeightInput.value !== "") {
        banglaLineHeightInput.value = floatBanglaLineHeightInput.value;
      }
      if (floatWordArabicFontSizeInput.value !== "") {
        wordArabicFontSizeInput.value = floatWordArabicFontSizeInput.value;
      }
      if (floatWordMeaningFontSizeInput.value !== "") {
        wordMeaningFontSizeInput.value = floatWordMeaningFontSizeInput.value;
      }
      if (floatWordNotesFontSizeInput.value !== "") {
        wordNotesFontSizeInput.value = floatWordNotesFontSizeInput.value;
      }

      writerOsmani.checked = floatWriterOsmani.checked;
      writerTawjih.checked = floatWriterTawjih.checked;

      applyFontSettings();
      renderCurrentSurah();
    }

    function openFloatingSettings() {
      syncSidebarToFloating();
      floatingSettingsPanel.classList.add("open");
      floatingSettingsPanel.focus();
    }

    function closeFloatingSettings() {
      floatingSettingsPanel.classList.remove("open");
    }

    // ===== Surah List & Selector =====

    function initSurahSelector() {
      if (!window.suras || !Array.isArray(window.suras)) return;

      // Dropdown
      window.suras.forEach((s) => {
        const opt = document.createElement("option");
        opt.value = s.number;
        opt.textContent = `${s.number}. ${s.nameBn}`;
        surahSelect.appendChild(opt);
      });

      // Sidebar chips
      surahList.innerHTML = "";
      window.suras.forEach((s) => {
        const chip = document.createElement("button");
        chip.type = "button";
        chip.className = "surah-chip";
        chip.dataset.number = s.number;
        chip.innerHTML = `
          <span class="surah-chip-number">${s.number}</span>
          <span class="surah-chip-name">${s.nameBn}</span>
        `;
        chip.addEventListener("click", () => {
          surahSelect.value = s.number;
          onSurahChange();
        });
        surahList.appendChild(chip);
      });
    }

    function highlightCurrentSurahChip(number) {
      document.querySelectorAll(".surah-chip").forEach((chip) => {
        chip.classList.toggle("active", String(chip.dataset.number) === String(number));
      });
    }

    function onSurahChange() {
      const value = surahSelect.value;
      if (!value) {
        currentSurah = null;
        currentSurahTitle.textContent = "‡¶∏‡ßÇ‡¶∞‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® ‚Äî ‡ßß‚Äì‡ßß‡ßß‡ß™ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶•‡ßá‡¶ï‡ßá";
        surahContent.innerHTML = `
          <div class="info-block">
            ‡¶∏‡ßÇ‡¶∞‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶®‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡ßÇ‡¶∞‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶®‡ßá‡¶á‡•§
          </div>
        `;
        highlightCurrentSurahChip(null);
        lastSurahNumber = null;
        return;
      }

      const suraMeta = window.suras.find((s) => String(s.number) === String(value));
      if (!suraMeta) return;

      currentSurahTitle.textContent = `${suraMeta.number}. ${suraMeta.nameBn} ‚Äî ${suraMeta.nameAr}`;
      highlightCurrentSurahChip(suraMeta.number);

      // Load JSON
      const fileName = suraMeta.file;
      fetch(fileName)
        .then((res) => res.json())
        .then((data) => {
          currentSurah = data;
          renderCurrentSurah();
          // Only scroll to top when surah actually changes
          if (lastSurahNumber !== suraMeta.number) {
            scrollToTop();
          }
          lastSurahNumber = suraMeta.number;
        })
        .catch((err) => {
          console.error("Error loading surah JSON:", err);
          surahContent.innerHTML = `
            <div class="info-block">
              <span style="color: ${"var(--danger)"};">‚ö†Ô∏è ‡¶∏‡ßÇ‡¶∞‡¶æ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§</span><br />
              ‡¶´‡¶æ‡¶á‡¶≤: <code>${fileName}</code> ‚Äî ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶´‡¶æ‡¶á‡¶≤‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ/JSON ‡¶∏‡¶ø‡¶®‡¶ü‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶∏ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§
            </div>
          `;
        });
    }

    // ===== Render Logic =====

    function renderCurrentSurah() {
      surahContent.innerHTML = "";

      if (!currentSurah) {
        surahContent.innerHTML = `
          <div class="info-block">
            ‡¶∏‡ßÇ‡¶∞‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶®‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡ßÇ‡¶∞‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶®‡ßá‡¶á‡•§
          </div>
        `;
        return;
      }

      const selectedWriters = getSelectedWriters();

      const container = document.createElement("div");

      // Meta block
      const metaDiv = document.createElement("div");
      metaDiv.className = "surah-meta";
      metaDiv.innerHTML = `
        <div class="surah-meta-main">
          <div class="name-ar">${currentSurah.nameAr || ""}</div>
          <div class="name-bn">${currentSurah.nameBn || ""} (${currentSurah.number})</div>
        </div>
        <div class="surah-meta-tags">
          <div class="pill pill-accent">
            <span class="icon">üìç</span>
            <span>${currentSurah.revelationPlace === "Makki" ? "‡¶Æ‡¶æ‡¶ï‡ßç‡¶ï‡ßÄ" : (currentSurah.revelationPlace === "Madani" ? "‡¶Æ‡¶æ‡¶¶‡¶æ‡¶®‡ßÄ" : "‡¶Ö‡¶ú‡¶æ‡¶®‡¶æ")}</span>
          </div>
          <div class="pill">
            <span class="icon">üî¢</span>
            <span>${currentSurah.ayahCount || (currentSurah.ayahs ? currentSurah.ayahs.length : "?")} ‡¶Ü‡ßü‡¶æ‡¶§</span>
          </div>
        </div>
      `;
      container.appendChild(metaDiv);

      // Bismillah
      if (currentSurah.hasBismillah && currentSurah.bismillah) {
        const b = currentSurah.bismillah;
        const bWrap = document.createElement("div");
        bWrap.className = "bismillah-block";

        const lines = [];
        if (b.bangla) {
          lines.push(`<div class="bismillah-bn">${b.bangla}</div>`);
        }

        let transHtml = "";
        if (currentMode !== "arabic" && b.translations) {
          if (currentMode === "translation" && selectedWriters.length > 0) {
            transHtml += `<div class="bismillah-trans">`;
            if (selectedWriters.includes("osmani") && b.translations.osmani) {
              transHtml += `<div><span class="ayah-trans-label">[‡¶ì‡¶∏‡¶Æ‡¶æ‡¶®‡ßÄ]</span>${b.translations.osmani}</div>`;
            }
            if (selectedWriters.includes("tawjih") && b.translations.tawjih) {
              transHtml += `<div><span class="ayah-trans-label">[‡¶§‡¶æ‡¶ì‡¶Ø‡ßÄ‡¶π]</span>${b.translations.tawjih}</div>`;
            }
            transHtml += `</div>`;
          }
        }

        bWrap.innerHTML = `
          <div class="bismillah-ar">${b.arabic || ""}</div>
          ${lines.join("")}
          ${transHtml}
        `;

        container.appendChild(bWrap);
      }

      // Ayahs
      if (!currentSurah.ayahs || !Array.isArray(currentSurah.ayahs)) {
        const info = document.createElement("div");
        info.className = "info-block";
        info.innerHTML = `‡¶è‡¶á ‡¶∏‡ßÇ‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ayahs array ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§ JSON data ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§`;
        container.appendChild(info);
      } else {
        currentSurah.ayahs.forEach((ayah) => {
          const card = document.createElement("div");
          card.className = "ayah-card";

          // Header
          const header = document.createElement("div");
          header.className = "ayah-header";
          header.innerHTML = `
            <div class="ayah-number">${ayah.ayahNumber}</div>
            <div class="ayah-meta">
              <span>‡¶Ü‡¶Ø‡¶º‡¶æ‡¶§ ${ayah.ayahNumber}</span>
            </div>
          `;
          card.appendChild(header);

          // Arabic
          const arDiv = document.createElement("div");
          arDiv.className = "ayah-text-ar";

          if (currentMode === "word" && Array.isArray(ayah.words) && ayah.words.length > 0) {
            ayah.words.forEach((w, idx) => {
              const span = document.createElement("span");
              span.className = "word-token";
              span.textContent = w.text || "";
              span.dataset.ayah = ayah.ayahNumber;
              span.dataset.index = idx;

              span.addEventListener("click", () => {
                document.querySelectorAll(".word-token").forEach((t) => t.classList.remove("active"));
                span.classList.add("active");
                openWordModal(ayah, w);
              });

              arDiv.appendChild(span);
            });
          } else {
            arDiv.textContent = ayah.arabic || "";
          }

          card.appendChild(arDiv);

          // Bangla (main ayah meaning)
          if (currentMode !== "arabic" && ayah.bangla) {
            const bnDiv = document.createElement("div");
            bnDiv.className = "ayah-text-bn";
            bnDiv.textContent = ayah.bangla;
            card.appendChild(bnDiv);
          }

          // Translations by writers (only in translation mode)
          if (currentMode === "translation" && ayah.translations && selectedWriters.length > 0) {
            const trDiv = document.createElement("div");
            trDiv.className = "ayah-translations";

            if (selectedWriters.includes("osmani") && ayah.translations.osmani) {
              const line = document.createElement("div");
              line.innerHTML = `<span class="ayah-trans-label">[‡¶ì‡¶∏‡¶Æ‡¶æ‡¶®‡ßÄ]</span>${ayah.translations.osmani}`;
              trDiv.appendChild(line);
            }

            if (selectedWriters.includes("tawjih") && ayah.translations.tawjih) {
              const line = document.createElement("div");
              line.innerHTML = `<span class="ayah-trans-label">[‡¶§‡¶æ‡¶ì‡¶Ø‡ßÄ‡¶π]</span>${ayah.translations.tawjih}`;
              trDiv.appendChild(line);
            }

            card.appendChild(trDiv);
          }

          container.appendChild(card);
        });
      }

      surahContent.appendChild(container);

      // Apply font settings every render
      applyFontSettings();
    }

    // ===== Word Modal (center popup) =====

    function openWordModal(ayah, word) {
      wordModalArabic.textContent = word.text || "";
      wordModalMeaning.textContent = word.meaningBn || "‚Äî";
      const notesText = word.notes || "";
      wordModalNotes.textContent = notesText || "‚Äî";

      const surahName = currentSurah ? currentSurah.nameBn || "" : "";
      const ayRef = `‡¶∏‡ßÇ‡¶∞‡¶æ ${surahName} ‚Äî ‡¶Ü‡ßü‡¶æ‡¶§ ${ayah.ayahNumber}`;
      wordModalAyahRef.textContent = ayRef;

      wordModalBackdrop.style.display = "flex";

      // ensure latest sizes for popup
      applyFontSettings();
    }

    wordModalClose.addEventListener("click", () => {
      wordModalBackdrop.style.display = "none";
      document.querySelectorAll(".word-token").forEach((t) => t.classList.remove("active"));
    });

    wordModalBackdrop.addEventListener("click", (e) => {
      if (e.target === wordModalBackdrop) {
        wordModalBackdrop.style.display = "none";
        document.querySelectorAll(".word-token").forEach((t) => t.classList.remove("active"));
      }
    });

    // ===== Event Bindings =====

    surahSelect.addEventListener("change", onSurahChange);

    modeWordBtn.addEventListener("click", () => setMode("word"));
    modeTransBtn.addEventListener("click", () => setMode("translation"));
    modeArabicBtn.addEventListener("click", () => setMode("arabic"));

    writerOsmani.addEventListener("change", () => {
      floatWriterOsmani.checked = writerOsmani.checked;
      renderCurrentSurah();
    });
    writerTawjih.addEventListener("change", () => {
      floatWriterTawjih.checked = writerTawjih.checked;
      renderCurrentSurah();
    });

    arabicFontSizeInput.addEventListener("input", applyFontSettings);
    banglaFontSizeInput.addEventListener("input", applyFontSettings);
    arabicLineHeightInput.addEventListener("input", applyFontSettings);
    banglaLineHeightInput.addEventListener("input", applyFontSettings);

    // NEW: separate controls listeners
    wordArabicFontSizeInput.addEventListener("input", applyFontSettings);
    wordMeaningFontSizeInput.addEventListener("input", applyFontSettings);
    wordNotesFontSizeInput.addEventListener("input", applyFontSettings);

    scrollTopBtn.addEventListener("click", scrollToTop);
    openSettingsBtn.addEventListener("click", toggleSettingsHighlight);

    bottomSurahBtn.addEventListener("click", () => {
      surahSelect.scrollIntoView({ behavior: "smooth", block: "center" });
    });
    bottomWordBtn.addEventListener("click", () => setMode("word"));
    bottomTransBtn.addEventListener("click", () => setMode("translation"));
    bottomSettingsBtn.addEventListener("click", toggleSettingsHighlight);

    // Floating settings events
    floatingSettingsToggle.addEventListener("click", () => {
      if (floatingSettingsPanel.classList.contains("open")) {
        closeFloatingSettings();
      } else {
        openFloatingSettings();
      }
    });

    floatingSettingsClose.addEventListener("click", closeFloatingSettings);

    floatingSettingsPanel.addEventListener("click", (e) => {
      // prevent closing when clicking inside
      e.stopPropagation();
    });

    document.addEventListener("click", (e) => {
      // close floating when clicking outside (not on toggle)
      if (
        floatingSettingsPanel.classList.contains("open") &&
        !floatingSettingsPanel.contains(e.target) &&
        e.target !== floatingSettingsToggle
      ) {
        closeFloatingSettings();
      }
    });

    // Floating inputs -> sync to sidebar & apply
    floatArabicFontSizeInput.addEventListener("input", syncFloatingToSidebar);
    floatBanglaFontSizeInput.addEventListener("input", syncFloatingToSidebar);
    floatArabicLineHeightInput.addEventListener("input", syncFloatingToSidebar);
    floatBanglaLineHeightInput.addEventListener("input", syncFloatingToSidebar);
    floatWordArabicFontSizeInput.addEventListener("input", syncFloatingToSidebar);
    floatWordMeaningFontSizeInput.addEventListener("input", syncFloatingToSidebar);
    floatWordNotesFontSizeInput.addEventListener("input", syncFloatingToSidebar);
    floatWriterOsmani.addEventListener("change", syncFloatingToSidebar);
    floatWriterTawjih.addEventListener("change", syncFloatingToSidebar);

    // ===== Init =====
    document.addEventListener("DOMContentLoaded", () => {
      initSurahSelector();
      // initial sync for floating panel default values
      syncSidebarToFloating();
    });
  </script>
</body>
</html>
